# MK Jul 2016

import logging.config
logging.config.fileConfig('logging.conf')
logger = logging.getLogger('runner')

from db.helper import *

class Malware():

    package = None
    tool = None
    result = None
    logfile = None

    def insert(self):
        insert = "insert into malware (package,tool,result,logfile) values ('%s', '%s', '%s', '%s')" % (self.package, self.tool, self.result, self.logfile)

        update = []
        if self.package is not None:
            update.append("package= VALUES(package)")
        if self.tool is not None:
            update.append("tool= VALUES(tool)")
        if self.result is not None:
            update.append("result= VALUES(result)")
        if self.logfile is not None:
            update.append("logfile= VALUES(logfile)")

        if update:
            sql = [insert, "on duplicate key update"]
            sql.append(", ".join(update))
        else:
            sql = [insert]
        sql.append(";")
        logger.debug(" ".join(sql))
        cur.execute(" ".join(sql))
